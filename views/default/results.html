{{extend 'layout.html'}}

{{block head}}
<title>Results - Poll it Dude</title>
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script>
    var poll_id = "{{=poll.id}}";
    var poll_url = "{{=URL('api', 'get_poll')}}";
    var polls_url = "{{=URL('api', 'get_polls')}}";
    var shareFacebookURL = "{{=URL('api', 'shareFacebookURL')}}";
    var getMovieLocationUrl = "{{=URL('api', 'getMovieLocation')}}";
</script>
{{end}}


<div class="main-content">

    <div id="vue-div" class="display:none">

    <a v-bind:href="shareFacebookURL">Share your poll on Facebook</a>
    <h1>Results</h1>
    <p>${poll.content}</p>


    <div v-if="pollActive">        
        <p>Poll is still active until: TIME</p>
        <iframe
            width="600"
            height="450"
            frameborder="0" style="border:0"
            v-bind:src="getMovieLocationUrl" allowfullscreen>
        </iframe>
        <div class="card-columns"> 
            <div v-for="movie in poll.movies" class="card">
                
                <div class="card-header">
                    ${movie.title}
                </div>

                <div class="card-body">
                    <h5 class="card-title">Votes: ${movie.votes}</h5>
                    <p class="card-text">
                        <small>
                            Submitted at: ${poll.created_on} by ${poll.name}
                            <br>
                            Last updated: ${poll.updated_on} by ${poll.name}
                        </small>
                    </p>
                </div>

            </div>
        </div>
    </div>


    <div v-if="!pollActive">
        <p>Poll has ended! Here are final results</p>
        <div class="card">                
            <div class="card-header">
                ${winningMovie.title}
            </div>

            <div class="card-body">
                <h5 class="card-title">Votes: ${winningMovie.votes}</h5>
                <p class="card-text">
                    <small>
                        Submitted at: ${poll.created_on} by ${poll.name}
                        <br>
                        Last updated: ${poll.updated_on} by ${poll.name}
                    </small>
                </p>
                <iframe
                    width="600"
                    height="450"
                    frameborder="0" style="border:0"
                    v-bind:src="getMovieLocationUrl" allowfullscreen>
                </iframe>

                <button class="btn btn-default" 
                    v-on:click="">
                    Button
                </button>
                <a v-bind:href="uberURL" class="btn btn-primary">Book an Uber</a>
                <a href="#" class="btn btn-primary">Buy Tickets</a>
            </div>

        </div>
    </div>



    </div>


</div>





<script src="{{=URL('static', 'js/default_results.js')}}"></script>
